<%- include('../partials/header') %>

<section class="page-header admin-header">
  <div class="container">
    <h1><i class="bi bi-box-seam me-2"></i>Manage Orders</h1>
  </div>
</section>

<section class="section-padding">
  <div class="container">
    <% if (orders.length > 0) { %>
      <div class="table-responsive">
        <table class="table admin-table">
          <thead>
            <tr>
              <th>Order ID</th>
              <th>Customer</th>
              <th>Items</th>
              <th>Amount</th>
              <th>Payment</th>
              <th>Status</th>
              <th>Date</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <% orders.forEach(order => { %>
              <tr>
                <td><code>#<%= order._id.toString().slice(-8).toUpperCase() %></code></td>
                <td>
                  <strong><%= order.user ? order.user.fullname : 'N/A' %></strong>
                  <br><small class="text-muted"><%= order.user ? order.user.email : '' %></small>
                </td>
                <td><%= order.items.length %> item(s)</td>
                <td><strong>&#8377;<%= order.totalAmount.toLocaleString('en-IN') %></strong></td>
                <td>
                  <span class="badge bg-<%= order.paymentStatus === 'Paid' ? 'success' : order.paymentStatus === 'Failed' ? 'danger' : 'warning' %>">
                    <%= order.paymentStatus %>
                  </span>
                </td>
                <td>
                  <span class="badge bg-<%= order.status === 'Delivered' ? 'success' : order.status === 'Cancelled' ? 'danger' : order.status === 'Shipped' ? 'info' : 'warning' %>">
                    <%= order.status %>
                  </span>
                </td>
                <td><%= order.createdAt.toLocaleDateString('en-IN') %></td>
                <td>
                  <form action="/admin/orders/<%= order._id %>/status" method="POST" class="d-flex gap-1 align-items-center">
                    <select name="status" class="form-select form-select-sm" style="width: auto;">
                      <% ['Pending', 'Confirmed', 'Processing', 'Shipped', 'Delivered', 'Cancelled'].forEach(s => { %>
                        <option value="<%= s %>" <%= order.status === s ? 'selected' : '' %>><%= s %></option>
                      <% }) %>
                    </select>
                    <button type="submit" class="btn btn-sm btn-primary"><i class="bi bi-check"></i></button>
                  </form>
                </td>
              </tr>
            <% }) %>
          </tbody>
        </table>
      </div>
    <% } else { %>
      <div class="empty-state">
        <i class="bi bi-inbox"></i>
        <h4>No orders yet</h4>
        <p>Orders will appear here once customers start purchasing</p>
      </div>
    <% } %>
  </div>
</section>

<%- include('../partials/footer') %>
